<?xml version="1.0" encoding="UTF-8"?>
<FlowConfiguration>
	<id>sasDetectionFlow</id>
	<name>sasDetectionFlow</name>
	<description>Flow for the SAS Detection manager</description>

	<workingDirectory>sasdetectionesb_work</workingDirectory>
	<autorun>true</autorun>

	<EventConsumerConfiguration>
		<id>sasdetectionesb_flow</id>
		<name>sasdetectionesb_flow</name>
		<description>sasdetectionesb_flow</description>

		<listenerId>SASDetectionConsumerLogger0</listenerId>
        <listenerId>SASCumulator0</listenerId>

		<workingDirectory>sasdetectionesb_work</workingDirectory>
		<performBackup>true</performBackup>
		
		<FileEventRule>
			<optional>false</optional>
			<originalOccurrencies>1</originalOccurrencies>
			<regex>.*\.xml</regex>
			<id>r1</id>
			<description>description</description>
			<name>test</name>
		</FileEventRule>
		
        <DetectionManagerConfiguration>
			<id>SASDETECTION</id>
			<description>description</description>
			<name>SAS Detections Manager</name>
			<serviceID>DetectionManagerService</serviceID>

			<listenerId>SASDetectionStatusActionLogger0</listenerId>
			<listenerId>SASDetectionActionLogger0</listenerId>
        
			<workingDirectory>sasdetectionesb_work</workingDirectory>
			<detectionsErrorLog>sasdetectionesb_work/config/errorlog.txt</detectionsErrorLog>
			<detectionsOutputDir>G:\data\sas\muscleshapes</detectionsOutputDir>
			<detectionConverterPath>sasdetectionesb_work/config/shapegen.py</detectionConverterPath>
			<detectionStyle>detection</detectionStyle>
			<converterTimeout>1200000</converterTimeout> <!-- milliseconds -->
			<crsDefinitionsDir>sasdetectionesb_work/config/prj</crsDefinitionsDir>
			<loggingDir>sasdetectionesb_work/log</loggingDir>
			<executablePath>C:\Apps\Python26\python.exe</executablePath>
			<gdalData>C:\Apps\gdalwin32-1.6\data</gdalData>
			<path>C:\Apps\Python26\DLLs</path>
			<xslPath>sasdetectionesb_work/config/task.xsl</xslPath>
<!--		<geoserverURL>http://192.168.1.17:8086/geoserver</geoserverURL>
			<geoserverUID>admin</geoserverUID>
			<geoserverPWD>geoserver</geoserverPWD>
			<geoserverUploadMethod>DIRECT</geoserverUploadMethod>
-->			<defaultNamespace>it.geosolutions</defaultNamespace>
		</DetectionManagerConfiguration>

        <SasEsbConfiguration>
			<id>sasDetectionESB</id>
			<serviceID>sasEsbService</serviceID>
			<name>SAS Detection ESB</name>
			<description>Sends SOAP messages to ESB</description>

            <listenerId>ESBCumulator0</listenerId>

            <serverURL>http://localhost:9090/sas-service/soap</serverURL>
            <geoserverURL>http://localhost:8080/geoserver-sas</geoserverURL>
        </SasEsbConfiguration>

	</EventConsumerConfiguration>

    <EventGeneratorConfiguration>
        <id>id</id>
        <name>test</name>
        <description>description</description>
        <serviceID>fsEventGeneratorService</serviceID>
        
        <wildCard>*.*</wildCard>
        <watchDirectory>sasdetectionesb_work/in</watchDirectory>
        <keepFiles>true</keepFiles>
        <osType>OS_UNDEFINED</osType>
        <eventType>FILE_ADDED</eventType>
    </EventGeneratorConfiguration>
    
	<ListenerConfigurations>
    	<StatusProgressListener>
    		<serviceID>statusListenerService</serviceID>
            <id>SASDetectionStatusActionLogger0</id>
    	</StatusProgressListener>
        
        <LoggingProgressListener>
            <serviceID>loggingListenerService</serviceID>
            <id>SASDetectionActionLogger0</id>

            <loggerName>SASDetectionActionLogger0</loggerName>
        </LoggingProgressListener>

        <LoggingProgressListener>
            <serviceID>loggingListenerService</serviceID>
            <id>SASDetectionESBLogger0</id>

            <loggerName>SASDetectionESBLogger0</loggerName>
        </LoggingProgressListener>

        <LoggingProgressListener>
            <serviceID>loggingListenerService</serviceID>
            <id>SASDetectionConsumerLogger0</id>

            <loggerName>SASDetectionConsumerLogger0</loggerName>
        </LoggingProgressListener>

        <CumulatingProgressListener>
            <serviceID>cumulatingListenerService</serviceID>
            <id>SASCumulator0</id>
        </CumulatingProgressListener>

        <CumulatingProgressListener>
            <serviceID>cumulatingListenerService</serviceID>
            <id>ESBCumulator0</id>
        </CumulatingProgressListener>
        
    </ListenerConfigurations>
    
</FlowConfiguration>