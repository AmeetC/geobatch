<?xml version="1.0" encoding="UTF-8"?>
<FlowConfiguration>
	
	<id>NETTUNOFlow</id>
	<description>NETTUNOFlow</description>
	<name>NETTUNOFlow</name>
	
	<workingDirectory>rep10workingdir/meteoam/nettuno</workingDirectory>
	<autorun>true</autorun>
	
	<EventGeneratorConfiguration>
		<wildCard>*</wildCard>
		<watchDirectory>rep10workingdir/meteoam/nettuno/in</watchDirectory>
		<osType>OS_UNDEFINED</osType>
		<eventType>FILE_ADDED</eventType>
		<id>NETTUNOFlow</id>
        <serviceID>fsEventGeneratorService</serviceID>
		<description>description</description>
		<name>test</name>
	</EventGeneratorConfiguration>
	
	<EventConsumerConfiguration>
		<id>nettuno</id>
		<description>nettuno</description>
		<name>nettuno</name>
		
		<workingDirectory>rep10workingdir/meteoam/nettuno/</workingDirectory>
		<performBackup>false</performBackup>
		
		<FileEventRule>
			<optional>false</optional>
			<originalOccurrencies>1</originalOccurrencies>
			<regex>.*\.*</regex>
			<id>r1</id>
			<description>description</description>
			<name>test</name>
		</FileEventRule>
		
		<OctaveFreeMarkerConfiguration>
			<serviceID>OctaveFreeMarkerGeneratorService</serviceID>
			<id>OctaveFreeMarkerGeneratorService</id>
			<description>OctaveFreeMarkerGeneratorService</description>
			<name>OctaveFreeMarkerConfiguration</name>
			<workingDirectory>rep10workingdir/meteoam/nettuno/</workingDirectory>
			<execute>../sheet_meteoam.xml</execute> <!-- relative to the working dir -->
			
			<cruise>rep10</cruise>
			<model>NETTUNO</model>
			<extension>.nc</extension>
			<outDir>nc/</outDir>
			
			<root>
			<!-- CANNOT USE A VARIABLE FOR THIS NODE SINCE
			SheetPreprocessor use that name to assign the
			preprocessor to use.
			Anyway if you use the FreeMarker action to filter
			this file before passing it to the octave action
			you can freely set this variable but this should
			be done into the FreeMarker configuration root
			map.
				<entry>
					<string>SHEETNAME</string>
					<string>NettunoSheet</string>
				</entry>
				-->
				<entry>
					<string>FUNCTION</string>
					<string>nettuno2nc</string>
				</entry>
				<entry>
					<string>SOURCEDIR</string>
					<string>/usr/share/octave/3.0.5/m/startup/octaverc</string>
				</entry>
				<!-- RUNTIME
				<entry>
					<string>WORKINGDIR</string>
					<string></string>
				</entry>
				<entry>
					<string>IN_FILE</string>
					<string>NettunoSheet</string>
				</entry>
				<entry>
					<string>OUT_FILE</string>
					<string>NettunoSheet</string>
				</entry>
				-->
			</root>
		</OctaveFreeMarkerConfiguration>
		
		<!--
		<OctaveConfiguration>
			<serviceID>NETTUNOGeneratorService</serviceID>
			<id>NETTUNOGeneratorService</id>
			<description>NETTUNOGeneratorService</description>
			<name>NETTUNOActionConfiguration</name>
			<workingDirectory>rep10workingdir/meteoam/nettuno/</workingDirectory>
			<octave>
			  <sheets>
			    <sheet name="NETTUNOFlow">
			      <commands>
			        <OctaveCommand executed="false">
						<command>source "/usr/share/octave/3.0.5/m/startup/octaverc";</command>
			        </OctaveCommand>
			        <OctaveCommand executed="false">
						<command>cd "/home/carlo/work/data/rep10workingdir/meteoam/scripts"</command>
			        </OctaveCommand>
			        <OctaveCommand executed="false">
						<command>env</command>
			        </OctaveCommand>
			        <OctaveCommand executed="false">
						<command>cd "/home/carlo/work/data/rep10workingdir/meteoam/nettuno"</command>
			        </OctaveCommand>
			      </commands>
			      <definitions/>
			      <functions>
			        <function name="${FUNCTION}">
				  <commands/>
			          <returns/>
			          <definitions>
			            <OctaveFile name="file_in" value="${IN_FILE}" output="false" input="true"/>
			            <OctaveFile name="file_out" value="${OUT_FILE}" output="false" input="true"/>
			          </definitions>
			        </function>
			      </functions>
			      <returns/>
			    </sheet>
			  </sheets>
			</octave>
		</OctaveConfiguration>
		-->
		<MetocActionConfiguration>
			<workingDirectory>rep10workingdir/meteoam/nettuno/nc/</workingDirectory>
			<flipY>false</flipY>
			<crs>EPSG:4326</crs>
			<envelope/>
			<metocDictionaryPath>registry_work/config/NURC-2010/Super-Ensemble/metoc-dictionary.xml</metocDictionaryPath>
			<metocHarvesterXMLTemplatePath>registry_work/config/NURC-2010/Super-Ensemble/Nurc-Cim_Schema/2010_07_13/example/iso-models-template.xml</metocHarvesterXMLTemplatePath>
			<serviceID>NetCDFCFGeodetic2GeoTIFFsGeneratorService</serviceID>
			<id>a2</id>
			<description>description2</description>
			<name>test2</name>
		</MetocActionConfiguration>
		
		<ImageMosaicActionConfiguration>
			<workingDirectory>rep10workingdir/meteoam/nettuno/nc</workingDirectory>
			<crs>EPSG:4326</crs>
			<envelope/>
			<dataTransferMethod>EXTERNAL</dataTransferMethod>
			<geoserverPWD>geoserver</geoserverPWD>
			<geoserverUID>admin</geoserverUID>
			<geoserverURL>http://localhost:8080/geoserver</geoserverURL>
			<wmsPath>/</wmsPath>
			<defaultNamespace>nurc</defaultNamespace>
			<defaultStyle>raster</defaultStyle>
			<styles/>
			<datastorePropertiesPath>registry_work/config/NURC-2010/datastore.properties</datastorePropertiesPath>
			<timeRegex>[0-9]{8}T[0-9]{9}Z(?!.*[0-9]{8}T[0-9]{9}Z.*)</timeRegex>
			<elevationRegex><![CDATA[(?<=_)(\\d{4}\\.\\d{3})(?=_)]]></elevationRegex>
			<serviceID>ImageMosaicGeneratorService</serviceID>
			<id>ImageMosaicService</id>
			<description>ImageMosaicService</description>
			<name>ImageMosaicService</name>
		</ImageMosaicActionConfiguration>
		
		<RegistryActionConfiguration>
			<workingDirectory>rep10workingdir/meteoam/nettuno/nc</workingDirectory>
			<crs>EPSG:4326</crs>
			<envelope/>
			<dataTransferMethod>DIRECT</dataTransferMethod>
			<geoserverPWD>geoserver</geoserverPWD>
			<geoserverUID>admin</geoserverUID>
			<geoserverURL>http://localhost:8080/geoserver</geoserverURL>
			<registryURL>http://localhost:8080/nurccatalogue/webservice</registryURL>
			<providerURL>http://localhost:8080/geobatch/rest/publish</providerURL>
			<metocDictionaryPath>registry_work/config/NURC-2010/Super-Ensemble/metoc-dictionary.xml</metocDictionaryPath>
			<metocHarvesterXMLTemplatePath>registry_work/config/NURC-2010/Super-Ensemble/Nurc-Cim_Schema/2010_07_13/example/iso-models-template.xml</metocHarvesterXMLTemplatePath>
			<wmsPath>/</wmsPath>
			<defaultNamespace>nurc</defaultNamespace>
			<defaultStyle>raster</defaultStyle>
			<styles/>
			<serviceID>RegistryHarvestingGeneratorService</serviceID>
			<id>a3</id>
			<description>description3</description>
			<name>test3</name>
		</RegistryActionConfiguration>
		
	</EventConsumerConfiguration>

</FlowConfiguration>
